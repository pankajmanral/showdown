{% extends 'base.html' %}
{% load static %}

{% block navbar %} {% endblock %}

{% block content %} 

    <div class="flex justify-between px-5 sm:px-28 h-20 items-center ">
        <h1 class="font-bold text-2xl">CheckOut</h1>
        <a href="{% url 'cart' %}"><i class="ri-handbag-line text-xl"></i></a>
    </div>
    <hr>

    <!-- template for mobile and tablet  -->
    <div class="relative block lg:hidden">
        <div id="summary" class="h-16 flex justify-between items-center bg-[#F5F5F5] px-5 sm:px-28 cursor-pointer">
            <h1 class="text-xs" id="summaryText">Open summary</h1>
            <h1 class="font-bold">RS 9999</h1>
        </div>
        <div id="summaryTable" class="mt-2 flex flex-col gap-3 px-5 sm:px-28">
            {% for i in data %}
            <div class="flex justify-between gap-2 mb-3">
                <div class="h-[3.8rem] border  rounded-lg w-16 flex justify-center bg-[#F5F5F5]">
                    <img class="h-full w-[80%]" src="{{ i.cart_product.product_image.url }}" alt="">
                </div>
                <div class="mt-2 w-60">
                    <h1 class="text-sm">{{ i.cart_product.product_name }}</h1>
                </div>
                <div class="mt-2 w-10 flex justify-end">
                    <h1 class="text-sm">{{ i.total_cost }}</h1>
                </div>
            </div>
            {% endfor %}
            <div class="flex justify-between">
                <div class="flex items-center">
                    <h1 class="text-sm">Subtotal -</h1>
                    <h1 class="text-sm ms-1">Count</h1>
                </div>
                <div>
                    <h1 class="text-sm">{ total_cost }</h1>
                </div>
            </div>
            <div class="flex justify-between">
                <div class="flex items-center">
                    <h1 class="text-sm">Estimated taxes</h1>
                </div>
                <div>
                    <h1 class="text-sm">{ cost }</h1>
                </div>
            </div>
            <div class="flex justify-between">
                <div class="flex items-center">
                    <h1 class="text-md font-bold">Total</h1>
                </div>
                <div>
                    <h1 class="text-md font-bold">{ total }</h1>
                </div>
            </div>
        </div>
        <div id="green" class="absolute bg-white top-16 h-screen w-full transition-top transition-all duration-500 ease-in-out">

            <div class="mt-3">
                <h1 class="text-xl font-bold px-5 sm:px-20">Delivery</h1>
            </div>

            <div class="w-full px-5">
                <form method="POST" class="flex flex-wrap justify-center items-center mt-5 gap-2">
                    {% csrf_token %}
                    
                    <input type="text" name="title" id="" placeholder="Title eg - Home" class="h-12 w-96 rounded-md cursor-pointer">
                    <input type="text" name="block_number" id="" placeholder="Block number" class="h-12 w-96 rounded-md cursor-pointer">
                    <input type="text" name="building" id="" placeholder="Building" class="h-12 w-96 rounded-md cursor-pointer">
                    <input type="text" name="street" id="" placeholder="Street" class="h-12 w-96 rounded-md cursor-pointer">
                    <input type="text" name="land_mark" id="" placeholder="LandMark" class="h-12 w-96 rounded-md cursor-pointer">
                    <input type="text" name="area" id="" placeholder="Area" class="h-12 w-96 rounded-md cursor-pointer">
                    <input type="text" name="city" id="" placeholder="City" class="h-12 w-96 rounded-md cursor-pointer">
                    <select name="state" id="" required class="h-12 w-96 rounded-md cursor-pointer">
                        {% for state_code,state_name in address.fields.state.choices %}
                            <option value="{{ state_code }}">{{ state_name }}</option>
                        {% endfor %}
                    </select>
                    <input type="number" name="pincode" id="" placeholder="Pincode" required class="h-12 w-96 rounded-md cursor-pointer">
                    <input type="submit" class="bg-black text-white px-5 py-1 rounded-md h-12 w-1/2 cursor-pointer focus:ouline-none focus:border-black" value="SUBMIT">
                </form>
            </div>
        </div>  
    </div>

    <!-- screen size bigger than tablet  -->
    <div class="hidden w-full lg:flex">
        <div class="w-1/2 ps-28">
            <h1 class="text-2xl font-bold mt-5">Delivery</h1>
            <form method="POST" class="w-[35rem] flex flex-wrap justify-center items-center gap-2 mt-5">
                {% csrf_token %}
                <input type="text" name="title" id="" placeholder="Title eg - Home" class="h-12 w-full rounded-md cursor-pointer">
                    <input type="text" name="block_number" id="" placeholder="Block number" class="h-12 w-[17.2rem] rounded-md cursor-pointer">
                    <input type="text" name="building" id="" placeholder="Building" class="h-12 w-[17.2rem] rounded-md cursor-pointer">
                    <input type="text" name="street" id="" placeholder="Street" class="h-12 w-full rounded-md cursor-pointer">
                    <input type="text" name="land_mark" id="" placeholder="LandMark" class="h-12 w-full rounded-md cursor-pointer">
                    <input type="text" name="area" id="" placeholder="Area" class="h-12 w-full rounded-md cursor-pointer">
                    <input type="text" name="city" id="" placeholder="City" class="h-12 w-[11.3rem] rounded-md cursor-pointer">
                    <select name="state" id="" required class="h-12 w-[11.3rem] rounded-md cursor-pointer">
                        {% for state_code,state_name in address.fields.state.choices %}
                            <option value="{{ state_code }}">{{ state_name }}</option>
                        {% endfor %}
                    </select>
                    <input type="number" name="pincode" id="" placeholder="Pincode" required class="h-12 w-[11.3rem] rounded-md cursor-pointer">
                    <input type="submit" class="bg-black mt-5 text-white px-5 py-1 rounded-md h-12 w-1/2 cursor-pointer focus:ouline-none focus:border-black" value="SUBMIT">
            </form>
        </div>
        <div class="bg-[#F5F5F5] w-1/2 h-[89vh] pe-28">
            <div class="w-full">
                <div class="py-5 ps-5">
                    {% for i in data %}
                    <div class="flex justify-between items-center gap-2 mb-3">
                        <div class="flex items-center gap-3">
                            <div class="h-[3.8rem] border rounded-lg w-16 flex justify-center bg-[#F5F5F5]">
                                <img class="h-full w-[80%]" src="{{ i.cart_product.product_image.url }}" alt="">
                            </div>
                            <h1 class="text-sm">{{ i.cart_product.product_name }}</h1>
                        </div>
                        <div class="mt-2 w-10 flex justify-end">
                            <h1 class="text-sm">{{ i.total_cost }}</h1>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="ps-5 mt-5">
                    <div class="flex justify-between">
                        <div class="flex items-center">
                            <h1 class="text-sm">Subtotal -</h1>
                            <h1 class="text-sm ms-1">Count</h1>
                        </div>
                        <div>
                            <h1 class="text-sm">{ total_cost }</h1>
                        </div>
                    </div>
                    <div class="flex justify-between mt-2">
                        <div class="flex items-center">
                            <h1 class="text-sm">Estimated taxes</h1>
                        </div>
                        <div>
                            <h1 class="text-sm">{ cost }</h1>
                        </div>
                    </div>
                    <div class="flex justify-between mt-2">
                        <div class="flex items-center">
                            <h1 class="text-md font-bold">Total</h1>
                        </div>
                        <div>
                            <h1 class="text-md font-bold">{ total }</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script>

        const summary = document.querySelector("#summary")
        const green = document.querySelector("#green")
        const name = document.querySelector("#name")
        const summaryTable = document.querySelector("#summaryTable")
        const summaryText = document.querySelector("#summaryText")
        let isOpen = false

        summary.addEventListener("click",()=>{

            const topHeight = summaryTable.offsetTop
            const tableHeight = summaryTable.offsetHeight
            const totalHeight = topHeight + tableHeight
            
            if(isOpen){
                green.style.top = '64px'
                summaryText.textContent = "Show summary"
            }
            else{
                green.style.top = `${totalHeight}px`
                summaryText.textContent = "Hide summary"
            }
            isOpen = !isOpen
        })

    </script>


{% endblock %}

<!-- <div class="sm:hidden w-full px-5 bg-red-300">
                    <div class="w-full mt-5">
                        <div class="flex items-center justify-between mt-1">
                            <label for="" class="text-sm w-24">Title  </label>
                            <input type="text" name="title">
                        </div>
                        <div class="flex items-center justify-between mt-1">
                            <label for="" class="text-sm w-24">Block Number  </label>
                            <input type="text"  name="block_number">
                        </div>
                        <div class="flex items-center justify-between mt-1">
                            <label for="" class="text-sm w-24">Building  </label>
                            <input type="text" name="building">
                        </div>
                        <div class="flex items-center justify-between mt-1">
                            <label for="" class="text-sm w-24">Street</label>
                            <input type="text" name="street">
                        </div>
                        <div class="flex items-center justify-between mt-1">
                            <label for="" class="text-sm w-24">Land Mark  </label>
                            <input type="text" name="land_mark">
                        </div>
                        <div class="flex items-center justify-between mt-1">
                            <label for="" class="text-sm w-24">Area  </label>
                            <input type="text" name="area">
                        </div>
                        <div class="flex items-center justify-between mt-1">
                            <label for="" class="text-sm w-24">City  </label>
                            <input type="text" name="city">
                        </div>
                        <div class="flex items-center justify-between mt-1">
                            <label for="" class="text-sm w-32">State  </label>
                            <select name="state"  class="w-[12.8rem]" id="state">
                                <option value="">Select a state</option>
                                {% for state_code, state_name in form.fields.state.choices %}
                                    <option value="{{ state_code }}">{{ state_name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
    
                </div>     -->
                
                <!-- <div class="hidden sm:block mt-5 h-[20rem] md:w-[40rem] lg:w-[50rem]">
                    <div class="h-full w-full grid grid-cols-2 grid-rows-5">
                        <div class="col-span-2">
                            <label for="" class=" w-28 inline-block">Title</label>
                            <input type="text" class="w-[81%]" name="title" id="">
                        </div>
                        <div>
                            <label for="" class=" w-28 inline-block">Block Number</label>
                            <input type="text" name="block_number" id="">
                        </div>
                        <div class="">
                            <label for="" class=" w-28 inline-block">Building</label>
                            <input type="text" name="building" id="">
                        </div>
                        <div>
                            <label for="" class=" w-28 inline-block">Street</label>
                            <input type="text" name="street" id="">
                        </div>
                        <div>
                            <label for="" class=" w-28 inline-block">Land Mark</label>
                            <input type="text" name="land_mark" id="">
                        </div>
                        <div>
                            <label for="" class=" w-28 inline-block">Area</label>
                            <input type="text" name="area" id="">
                        </div>
                        <div>
                            <label for="" class=" w-28 inline-block">City</label>
                            <input type="text" name="city" id="">
                        </div>
                        <div class="col-span-2">
                            <label for="" class=" w-28 inline-block">State</label>
                            <select name="state"  class="w-[30%]" id="state">
                                <option value="" class="">Select a state</option>
                                {% for state_code, state_name in form.fields.state.choices %}
                                    <option value="{{ state_code }}">{{ state_name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div> -->